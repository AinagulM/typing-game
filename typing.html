<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Клавиатурный тренажёр</title>
<style>
    body {
        font-family: Arial, sans-serif;
        text-align: center;
        background: #f7f7f7;
    }
    h1 {
        font-size: 32px;
    }
    #letter {
        font-size: 120px;
        font-weight: bold;
        margin: 20px;
        color: #333;
    }
    #keyboard {
        width: 600px;
        margin: 20px auto;
        display: grid;
        grid-template-columns: repeat(12, 1fr);
        gap: 5px;
    }
    .key {
        padding: 15px;
        background: #fff;
        border: 2px solid #ccc;
        border-radius: 8px;
        font-size: 22px;
        text-align: center;
        transition: 0.2s;
    }
    .highlight {
        background: #ffeb3b;
        border-color: #f1c40f;
    }
    #exitBtn {
        margin-top: 20px;
        padding: 10px 20px;
        font-size: 20px;
        background: #d9534f;
        color: white;
        border: none;
        border-radius: 8px;
        cursor: pointer;
    }
    #exitBtn:hover {
        background: #c9302c;
    }
</style>
</head>
<body>

<h1>Тренажёр русской клавиатуры</h1>

<div id="trainerContainer">

<div id="letter">А</div>

<div id="keyboard"></div>

<div id="speedControl">
    <label>Скорость появления букв (мс): </label>
    <input type="range" id="speed" min="800" max="4000" step="200" value="2000">
    <span id="speedValue">2000</span>
</div>

<button id="exitBtn">Завершить</button>

</div>

<div id="endMessage" style="display:none; font-size:32px; margin-top:50px;">
    Тренажёр завершён
</div>

<script>
const russianLetters = [
    "Й","Ц","У","К","Е","Н","Г","Ш","Щ","З","Х","Ъ",
    "Ф","Ы","В","А","П","Р","О","Л","Д","Ж","Э",
    "Я","Ч","С","М","И","Т","Ь","Б","Ю"
];

const keyboardDiv = document.getElementById("keyboard");
const letterDiv = document.getElementById("letter");
const speedSlider = document.getElementById("speed");
const speedValue = document.getElementById("speedValue");
const exitBtn = document.getElementById("exitBtn");
const trainerContainer = document.getElementById("trainerContainer");
const endMessage = document.getElementById("endMessage");

// Создаём виртуальную клавиатуру
russianLetters.forEach(le => {
    const key = document.createElement("div");
    key.className = "key";
    key.textContent = le;
    key.id = "key_" + le;
    keyboardDiv.appendChild(key);
});

// Функция выбора случайной буквы
function newLetter() {
    currentLetter = russianLetters[Math.floor(Math.random() * russianLetters.length)];
    letterDiv.textContent = currentLetter;

    document.querySelectorAll(".key").forEach(k => k.classList.remove("highlight"));
    const key = document.getElementById("key_" + currentLetter);
    if (key) key.classList.add("highlight");
}

// ★ Звук правильного ответа
function beepCorrect() {
    const audio = new AudioContext();
    const osc = audio.createOscillator();
    const gain = audio.createGain();

    osc.frequency.value = 700;
    gain.gain.value = 0.15;

    osc.connect(gain);
    gain.connect(audio.destination);

    osc.start();
    osc.stop(audio.currentTime + 0.15);
}

let currentLetter = "А";
let interval = setInterval(newLetter, 2000);
newLetter();

// Скорость смены букв
speedSlider.addEventListener("input", () => {
    speedValue.textContent = speedSlider.value;
    clearInterval(interval);
    interval = setInterval(newLetter, speedSlider.value);
});

// Проверка правильного нажатия клавиши
document.addEventListener("keydown", (e) => {
    let key = e.key.toUpperCase();

    // Если нажата русская буква — оставляем как есть
    // Если английская — пробуем русскую раскладку
    const map = {
        "F":"А","I":"Ш","O":"Щ","V":"М","B":"И","U":"Г","P":"З","Y":"Н"
    };

    if (map[key]) key = map[key];

    if (key === currentLetter) {
        beepCorrect();
        newLetter();
    }
});

// ✔ Кнопка "Завершить"
exitBtn.addEventListener("click", () => {
    clearInterval(interval);
    trainerContainer.style.display = "none";
    endMessage.style.display = "block";
});
</script>

</body>
</html>
